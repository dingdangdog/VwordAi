# 功能设计文档

## 项目概述

本项目是一个基于 Electron 的文本转语音软件。用户可以通过该软件将文本转化为语音，支持自定义多个项目和章节的设置，如服务商、声音角色、语速、情感等。同时支持第三方服务商的密钥配置，使用户可以完全免费使用。UI 需要支持主题切换功能，以实现基础的亮/暗模式切换。

## 系统架构

- **主进程**（Electron 主进程）
  - 处理与操作系统的交互、文件操作、API 请求等。
  - 管理应用的生命周期，维护全局状态。
- **渲染进程**（Vue 前端）
  - 提供用户界面与交互，展示文本、语音设置界面等。
  - 通过 IPC 与主进程进行通信，进行语音生成、服务商密钥配置等操作。
- **依赖**
  - **主进程依赖**：
    - Electron
    - Axios（用于 API 请求，调用第三方服务商接口）
  - **渲染进程依赖**：
    - Vue 3（使用 setup 语法糖）
    - vue-router（用于页面路由管理）
    - TypeScript（用于静态类型检查）
    - Pinia（用于状态管理）
    - TailwindCSS（用于快速布局与样式）

------

## 功能模块

## 1. 项目与章节管理

### 1.1 创建/管理项目

- 用户可以创建新项目，每个项目可以包含多个章节。
- 每个项目有以下设置：
  - **项目名称**：字符串，必须唯一。
  - **默认语音设置**：服务商、声音角色、语速、情感等。
  - 默认设置保存到项目中，如果没有设置，默认为空。

### 1.2 创建/管理章节

- 用户可以创建新的章节，章节会继承项目的默认设置。
- 用户可以在章节中修改设置（如果需要），包括：
  - **语音服务商**：选择第三方服务商，调用不同的 API。
  - **声音角色**：设置使用的声音角色，如男声、女声等。
  - **语速**：设置语速，通常有慢、正常、快等选项。
  - **情感**：如普通、兴奋、悲伤等。

### 1.3 项目与章节的关系

- 每个项目包含多个章节，章节是项目的子级。
- 用户在选择章节时，可以修改该章节的设置，或者使用项目的默认设置。

## 2. 第三方服务商的密钥配置

### 2.1 配置页面

- 用户可以在设置中配置第三方服务商的个人密钥。
- 每个服务商有以下字段：
  - **服务商名称**（例如 Azure, Google Cloud TTS）
  - **API 密钥**：用户需要输入的密钥。
  - **测试连接**按钮：用于验证密钥是否有效。

### 2.2 密钥的使用

- 配置密钥后，应用会将用户的密钥信息发送给主进程，由主进程通过 Axios 请求第三方 API。
- 每次用户发起语音合成时，主进程会自动使用相应的服务商 API。

## 3. 语音设置与生成

### 3.1 语音设置

- 用户为每个项目和章节设置不同的语音参数，包括：
  - **语音服务商**
  - **声音角色**
  - **语速**
  - **情感**

### 3.2 语音生成

- 用户在章节页面点击“生成语音”按钮后，应用将通过配置的服务商和参数发起请求。
- 主进程负责调用服务商 API，生成语音并返回给渲染进程。
- 渲染进程接收到语音文件后，提供“播放”、“下载”按钮供用户操作。

## 4. UI 主题切换功能

### 4.1 主题切换

- 应用支持亮/暗模式切换，用户可以在设置中选择主题。
- 通过 TailwindCSS 来实现主题切换，使用 CSS 类控制主题的样式。
- 切换时，页面会即时更新，无需刷新。

### 4.2 默认主题设置

- 应用在首次启动时会检查系统主题，自动设置为系统主题（亮/暗模式）。
- 用户可以在设置中永久保存主题选择。

## 5. 项目设置与用户体验

### 5.1 项目与章节列表

- 用户界面展示所有项目和其章节，章节下有各项操作按钮：编辑、删除、生成语音等。
- 章节列表支持拖拽排序，方便用户管理章节顺序。

### 5.2 设置与配置

- 应用提供一个配置面板，用户可以设置语音合成的相关参数，如语音服务商、默认语速、情感等。
- 配置页支持表单校验，防止用户输入无效或错误的配置项。

## 6. 安全性与性能

### 6.1 密钥管理

- 所有用户的密钥信息仅保存在本地，不上传至服务器。
- 配置的密钥加密保存，保证用户的隐私安全。

### 6.2 性能优化

- 在生成语音时，采用异步请求和进度条展示，避免应用卡顿。
- 在语音生成过程中，提供用户反馈，如“正在生成”提示。

## 7. 其他功能

### 7.1 导入与导出项目

- 用户可以导入或导出项目，支持 JSON 格式保存项目数据。
- 导入时，应用自动解析并生成项目与章节。

### 7.2 错误提示与日志

- 在生成语音或配置密钥时，提供详细的错误信息，如“API 密钥无效”或“网络连接失败”等。
- 错误信息保存在日志文件中，用户可以查看历史记录。

------

# 任务分配（针对一般程序员）

## 1. 主进程（Electron）

- **任务**：
  - 创建主进程脚本，负责启动 Electron 应用、加载渲染进程。
  - 处理与外部 API 的通信（使用 Axios），如请求语音合成服务。
  - 管理用户配置，如存储和加载 API 密钥、主题设置等。

## 2. 渲染进程（Vue 3）

- **任务**：
  - 使用 Vue 3 编写用户界面，支持项目与章节的创建、修改和删除。
  - 实现语音设置界面，支持服务商、声音角色、语速、情感等选择。
  - 实现主题切换功能，使用 TailwindCSS 控制样式。
  - 通过 Vue Router 管理不同页面，如项目管理、章节管理、设置页面等。
  - 使用 Pinia 管理状态，如当前项目、章节及其设置。

## 3. UI 设计与实现

- **任务**：
  - 使用 TailwindCSS 完成页面布局与样式设计。
  - 确保界面响应式，适应不同屏幕尺寸。
  - 实现按钮、输入框、下拉菜单等组件的交互效果。

## 4. 第三方服务商的密钥配置

- **任务**：
  - 在设置页面中实现用户输入第三方 API 密钥的表单。
  - 实现 API 密钥的验证与错误提示。
  - 配置密钥存储，确保密钥的安全性。

## 5. 语音合成功能

- **任务**：
  - 实现通过配置服务商与参数调用语音合成 API 的功能。
  - 在用户生成语音后，提供播放、下载等操作。
  - 处理语音生成过程中的错误，并向用户展示反馈。

## 6. 主题切换

- **任务**：
  - 实现基础的亮/暗模式切换功能。
  - 使用 TailwindCSS 来控制主题样式。
  - 保持主题设置在应用重启后生效。

------

# 依赖包和安装

1. **Electron**：
   - 安装 Electron，作为桌面应用的基础框架。
   - `npm install electron --save-dev`
2. **Vue 3 & 相关库**：
   - 安装 Vue 3、Vue Router、Pinia、TypeScript、TailwindCSS。
   - `npm install vue@next vue-router@next pinia typescript tailwindcss`
3. **Axios**：
   - 安装 Axios，用于与第三方服务商 API 通信。
   - `npm install axios`
